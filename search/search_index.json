{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documentation SC940D","text":"<p>Bienvenue sur la documentation officielle de la carte SC940D, composant \"Boitier Pi\u00e8ce de Vie\" de la solution domotique Essensys Atrium.</p>"},{"location":"#a-propos-du-projet","title":"\u00c0 propos du projet","text":"<p>La carte SC940D est une unit\u00e9 de contr\u00f4le centrale con\u00e7ue pour l'automatisation du b\u00e2timent. Elle agit comme une passerelle et un contr\u00f4leur d'actionneurs, g\u00e9rant l'\u00e9clairage, les stores et d'autres charges CA via des relais embarqu\u00e9s.</p> <p>Ce projet est Open Source Hardware. Vous trouverez ici toutes les informations n\u00e9cessaires pour comprendre, fabriquer, r\u00e9parer et int\u00e9grer cette carte.</p>"},{"location":"#apercu-du-schema","title":"Aper\u00e7u du sch\u00e9ma","text":"<p>Pour vous donner un aper\u00e7u rapide, voici les \u00e9l\u00e9ments cl\u00e9s du circuit (Microcontr\u00f4leur et Connecteurs) :</p> <p> Figure 1: Sch\u00e9ma du c\u0153ur num\u00e9rique (Microcontr\u00f4leur)</p> <p> Figure 2: Sch\u00e9ma des connecteurs et interfaces</p>"},{"location":"#contenu-de-la-documentation","title":"Contenu de la documentation","text":""},{"location":"#architecture","title":"\ud83c\udfdb\ufe0f Architecture","text":"<p>Comprenez le fonctionnement interne de la carte, son microcontr\u00f4leur PIC16F946 et son \u00e9tage de puissance. \u27a1\ufe0f Architecture Overview</p>"},{"location":"#hardware","title":"\ud83d\udd0c Hardware","text":"<p>D\u00e9tails techniques, recommandations de fabrication (DFM) et gestion de l'alimentation. \u27a1\ufe0f Sp\u00e9cifications Hardware</p>"},{"location":"#telechargements","title":"\ud83d\udcbe T\u00e9l\u00e9chargements","text":"<p>Acc\u00e9dez aux fichiers sources pour la production : sch\u00e9mas PDF, mod\u00e8les 3D STEP et fichiers de fabrication Gerber. \u27a1\ufe0f Espace de t\u00e9l\u00e9chargement</p>"},{"location":"#structure-du-depot","title":"Structure du d\u00e9p\u00f4t","text":"<p>Le code source et les fichiers de conception sont organis\u00e9s comme suit : - SC940D/ : Dossier principal du projet (Hardware Altium).     - Schematics : Sch\u00e9mas \u00e9lectroniques.     - PCB Layout : Routage de la carte.    - Gerbers : Fichiers de fabrication.</p>"},{"location":"Architecture_Overview/","title":"Vue d'ensemble de l'Architecture : Bo\u00eetier Essensys SC940D","text":""},{"location":"Architecture_Overview/#1-description-generale","title":"1. Description G\u00e9n\u00e9rale","text":"<p>Le SC940D est une unit\u00e9 centrale de contr\u00f4le (\"Bo\u00eetier Pi\u00e8ce de Vie\") con\u00e7ue pour l'automatisation des b\u00e2timents. Il agit comme une passerelle et un contr\u00f4leur d'actionneurs, g\u00e9rant l'\u00e9clairage, les volets roulants et d'autres charges 230V via des relais embarqu\u00e9s.</p> <p></p> <p>T\u00e9l\u00e9charger le Sch\u00e9ma Complet (PDF)</p>"},{"location":"Architecture_Overview/#2-cur-de-traitement-communication","title":"2. C\u0153ur de Traitement &amp; Communication","text":""},{"location":"Architecture_Overview/#microcontroleur-mcu","title":"Microcontr\u00f4leur (MCU)","text":"<ul> <li>Composant: Microchip PIC16F946 (MCU CMOS 8-bit).</li> <li>Bo\u00eetier: 64-pin TQFP (<code>PIC16F946-I/PT</code>).</li> <li>R\u00f4le: G\u00e8re la logique locale, les signaux de contr\u00f4le des relais, et s'interface avec le module de communication. <ul> <li>Note: Le PIC16F946 poss\u00e8de un pilote LCD, mais il a probablement \u00e9t\u00e9 choisi ici pour son grand nombre d'entr\u00e9es/sorties (64 broches) ou pour des raisons d'historique composant.</li> </ul> </li> </ul>"},{"location":"Architecture_Overview/#module-de-communication-cur","title":"Module de Communication (\"C\u0153ur\")","text":"<ul> <li>Composant: SC943-0C (Module Personnalis\u00e9).</li> <li>Empreinte: <code>SI943C_REV_A</code>.</li> <li>Description: Identifi\u00e9 comme une carte fille. Compte tenu de la nature du syst\u00e8me, ce module g\u00e8re probablement la communication RF (ex: LoRa, Zigbee, ou protocole propri\u00e9taire 868MHz).</li> <li>Interface: Connect\u00e9 au PCB principal via des connecteurs headers.</li> </ul>"},{"location":"Architecture_Overview/#3-chaine-dalimentation","title":"3. Cha\u00eene d'Alimentation","text":"<ul> <li>Entr\u00e9e: 12V DC (Nominale, fournie via connecteur).</li> <li>R\u00e9gulateur Principal: LMR12010YMK (Texas Instruments).<ul> <li>Type: Convertisseur DC-DC Step-down (Buck).</li> <li>Bo\u00eetier: SOT-23-6.</li> <li>Efficacit\u00e9: Haute efficacit\u00e9 (&gt;85%) compar\u00e9e aux r\u00e9gulateurs lin\u00e9aires, id\u00e9al pour minimiser l'\u00e9chauffement dans un bo\u00eetier ferm\u00e9.</li> </ul> </li> <li>Protection:<ul> <li>VDR1, VR2, VR3: Varistances (\u00e9quivalent <code>VDR_S10K_275</code> pour la suppression des transitoires sur le secteur/entr\u00e9es.</li> <li>SMF5V0A: Diodes TVS pour la protection ESD/Surtensions sur les lignes de signal basse tension.</li> </ul> </li> </ul>"},{"location":"Architecture_Overview/#4-actionneurs-interfaces","title":"4. Actionneurs &amp; Interfaces","text":""},{"location":"Architecture_Overview/#sorties-relais","title":"Sorties Relais","text":"<p>La carte dispose d'une haute densit\u00e9 de relais pour la commutation de charges : -   Relais Haute Puissance: S\u00e9rie Finder 40.61 (16A, SPDT). Utilis\u00e9s pour les charges principales. -   Relais Compacts: S\u00e9rie Finder 34.51 (6A, Ultra-mince). Utilis\u00e9s pour les canaux de faible puissance ou \u00e0 espace contraint. -   Pilotes: ZXMN3A01F (MOSFETs Canal-N) utilis\u00e9s pour piloter les bobines des relais.</p>"},{"location":"Architecture_Overview/#connecteurs-borniers","title":"Connecteurs / Borniers","text":"<ul> <li>Utilisation intensive de borniers PCB verticaux Phoenix Contact (s\u00e9rie <code>FFKDS</code>) pour le c\u00e2blage terrain (Capteurs, Bus, Alimentation).</li> <li>HE10 / IDC: Le connecteur <code>IDC2P54_26P</code> implique une interface par c\u00e2ble nappe 26 broches, possiblement pour la programmation, l'extension ou la connexion en fa\u00e7ade.</li> </ul>"},{"location":"Architecture_Overview/#5-technologie-pcb","title":"5. Technologie PCB","text":"<ul> <li>Couches: Carte 4 Couches.<ul> <li>L1 (Top): Signaux &amp; Composants.</li> <li>L2 (G1): Plan de Masse Interne (GND) - Critique pour l'immunit\u00e9 au bruit.</li> <li>L3 (G2): Plan d'Alimentation Interne (VCC) - Probablement divis\u00e9 pour 12V / 3.3V / 5V.</li> <li>L4 (Bottom): Signaux &amp; composants secondaires.</li> </ul> </li> </ul>"},{"location":"DFM_Recommendations/","title":"Recommandations DFM (Design for Manufacturing) &amp; Optimisation","text":""},{"location":"DFM_Recommendations/#1-empilement-pcb-fabrication","title":"1. Empilement PCB &amp; Fabrication","text":"<ul> <li>Empilement Actuel: 4 Couches (Sig/GND/PWR/Sig).</li> <li>Recommandation: Assurez-vous que les profils d'imp\u00e9dance contr\u00f4l\u00e9e sont sp\u00e9cifi\u00e9s si le module de communication (<code>SC943</code>) utilise des lignes haute vitesse ou des antennes externes rout\u00e9es sur la carte principale.</li> <li>Tailles de Per\u00e7age: V\u00e9rifiez que les mises \u00e0 jour de tol\u00e9rance de la \"Release 16.0\" sont compatibles avec le fabricant de PCB choisi (capacit\u00e9s standard vs avanc\u00e9es).</li> </ul>"},{"location":"DFM_Recommendations/#2-testabilite-dft","title":"2. Testabilit\u00e9 (DFT)","text":"<ul> <li>Points de Test: La conception inclut <code>MIR1</code>, <code>MIR2</code>, <code>MIR3</code> (Mires fiduciales) mais manque de points de test explicitement \u00e9tiquet\u00e9s pour les signaux critiques (ex: <code>TP_3V3</code>, <code>TP_GND</code>, <code>TP_MCLR</code>).</li> <li>Recommandation: Ajouter des pastilles de test d\u00e9di\u00e9es (diam\u00e8tre 1mm) pour :<ul> <li>Rails de Tension (12V, 5V, 3.3V).</li> <li>Bus de Communication (Lignes TX/RX vers le module).</li> <li>Broches ICSP / Programmation pour le PIC16F946 (sauf si g\u00e9r\u00e9 par le connecteur HE10).</li> </ul> </li> </ul>"},{"location":"DFM_Recommendations/#3-assemblage-gestion-thermique","title":"3. Assemblage &amp; Gestion Thermique","text":"<ul> <li>Densit\u00e9 de Relais: La carte embarque environ 17 relais.<ul> <li>Risque: \u00c9chauffement localis\u00e9 important si plusieurs relais adjacents (<code>K1</code>-<code>K3</code>, <code>K4</code>-<code>K9</code>) sont actifs simultan\u00e9ment.</li> <li>Att\u00e9nuation: Assurez-vous que le bo\u00eetier dispose de fentes de ventilation au-dessus de la banque de relais. V\u00e9rifiez la largeur des pistes PCB pour le contact \"Commun\" des relais (~16A n\u00e9cessite une largeur de cuivre significative ou des plans de masse).</li> </ul> </li> <li>D\u00e9gagement des Composants: Les borniers verticaux (<code>Phoenix Contact FFKDS</code>) sont hauts. Assurez-vous qu'ils n'interf\u00e8rent pas avec le couvercle du bo\u00eetier ou le placement de la carte fille (<code>SC943</code>).</li> </ul>"},{"location":"DFM_Recommendations/#4-cycle-de-vie-des-composants","title":"4. Cycle de Vie des Composants","text":"<ul> <li>PIC16F946: C'est un produit ancien et mature. V\u00e9rifiez la disponibilit\u00e9 \u00e0 long terme ou envisagez de migrer vers une s\u00e9rie PIC16F1xxx ou PIC18F plus r\u00e9cente pour une meilleure densit\u00e9 de code et une consommation r\u00e9duite.</li> <li>LMR12010: Actif et bonne disponibilit\u00e9.</li> <li>Relais: Les s\u00e9ries Finder 40/34 sont des standards de l'industrie avec une excellente disponibilit\u00e9.</li> </ul>"},{"location":"Hardware_ChangeLog/","title":"Historique des Modifications Mat\u00e9rielles (SC940D)","text":"<p>Ce document retrace l'historique des r\u00e9visions du PCB SC940D tel qu'extrait des fichiers de conception.</p> Version Description Criticit\u00e9 Release 16.0 Version Actuelle. Ajout des valeurs de tol\u00e9rance pour la taille des trous de Pads/Vias. Caution Release 15.1 Support du texte PCB multi-lignes ajout\u00e9. Note : v\u00e9rifier le rendu du texte sur les anciens logiciels CAM. Caution Release 15.0 Support des masques de soudure s\u00e9par\u00e9s pour le dessus et le dessous des pads ajout\u00e9. Caution"},{"location":"Hardware_ChangeLog/#modifications-anciennes-non-verifiees","title":"Modifications Anciennes / Non V\u00e9rifi\u00e9es","text":"<p>[!NOTE] Les anciennes r\u00e9visions (Pr\u00e9-15.0) ne sont pas d\u00e9taill\u00e9es dans l'export actuel. Veuillez vous r\u00e9f\u00e9rer aux archives dans <code>SC940D/_Archives</code> si disponibles.</p>"},{"location":"Hardware_ChangeLog/#problemes-connus-design-actuel","title":"Probl\u00e8mes Connus (Design Actuel)","text":"<ul> <li>Manque de Documentation: Le module \"C\u0153ur\" (<code>SC943</code>) manque de sch\u00e9ma d\u00e9taill\u00e9 dans l'arborescence principale du projet.</li> <li>Saut de D\u00e9signateurs: Les d\u00e9signateurs des composants sautent des valeurs (ex: Relais K1-K17, puis un trou ?), typique des conceptions ayant \u00e9volu\u00e9.</li> </ul>"},{"location":"Power_Budget/","title":"Estimation du Budget de Puissance : SC940D","text":"<p>[!WARNING] Ce budget est une estimation th\u00e9orique bas\u00e9e sur les fiches techniques des composants et des valeurs typiques. Une v\u00e9rification r\u00e9elle sur le mat\u00e9riel est requise.</p>"},{"location":"Power_Budget/#1-etats-du-systeme","title":"1. \u00c9tats du Syst\u00e8me","text":"<p>Nous d\u00e9finissons deux \u00e9tats de puissance principaux pour l'analyse : 1.  Repos / Veille (Idle): MCU en marche, Module communication en r\u00e9ception/sommeil, aucun relais actif. 2.  Transmission Max: Module communication en \u00e9mission (TX), MCU actif. 3.  Activation Compl\u00e8te: Tous les relais activ\u00e9s (Pire Cas).</p>"},{"location":"Power_Budget/#2-analyse-de-consommation-par-composant","title":"2. Analyse de Consommation par Composant","text":""},{"location":"Power_Budget/#a-cur-logique-rail-33v-5v","title":"A. C\u0153ur Logique (Rail 3.3V / 5V)","text":"Composant \u00c9tat Courant (Est.) Puissance (Est.) PIC16F946 Marche (4MHz) ~2 mA 10 mW PIC16F946 Sommeil &lt; 1 \u00b5A ~0 mW SC943 (Module) Repos/RX ~10-20 mA ~50-100 mW SC943 (Module) TX (RF Haut) ~100-150 mA ~500 mW Protection/Fuite Veille &lt; 100 \u00b5A &lt; 1 mW"},{"location":"Power_Budget/#b-actionneurs-rail-12v","title":"B. Actionneurs (Rail 12V)","text":"<p>Note : Les bobines des relais sont les principaux consommateurs d'\u00e9nergie.</p> Composant Quantit\u00e9 Courant Unitaire (12V) Puiss. Unitaire Puiss. Max Totale Finder 40.61 ~12 ~40 mA (0.5W) 0.5 W 6.0 W Finder 34.51 ~5 ~15 mA (0.17W) 0.17 W 0.85 W"},{"location":"Power_Budget/#3-estimation-totale-de-puissance-entree-12v","title":"3. Estimation Totale de Puissance (Entr\u00e9e 12V)","text":""},{"location":"Power_Budget/#scenario-1-veille-aucun-relais","title":"Sc\u00e9nario 1 : Veille (Aucun Relais)","text":"<ul> <li>Charge Logique: ~20mA @ 5V (via Buck)</li> <li>Efficacit\u00e9 Buck: ~85%</li> <li>Courant Entr\u00e9e (12V): ~1-10 mA.</li> <li>Puissance Totale: &lt; 0.2 W.</li> </ul>"},{"location":"Power_Budget/#scenario-2-operation-typique-2-relais-actifs-rx","title":"Sc\u00e9nario 2 : Op\u00e9ration Typique (2 Relais Actifs + RX)","text":"<ul> <li>Relays: 2x 40.61 = 1 W.</li> <li>Logique: 0.1 W.</li> <li>Puissance Totale: ~1.1 W.</li> </ul>"},{"location":"Power_Budget/#scenario-3-pire-cas-tous-relais-on-tx","title":"Sc\u00e9nario 3 : Pire Cas (Tous Relais ON + TX)","text":"<ul> <li>Relais: 6.85 W.</li> <li>Logique (TX): 0.5 W / 0.85 (Eff) \u2248 0.6 W.</li> <li>Puissance Totale: ~7.5 W.</li> </ul>"},{"location":"Power_Budget/#4-recommandations","title":"4. Recommandations","text":"<ol> <li>Dimensionnement PSU: L'alimentation 12V amont doit \u00eatre dimensionn\u00e9e pour au moins 10W (ou ~1A) pour g\u00e9rer le pire cas et le courant d'appel.</li> <li>Thermique: 7.5W repr\u00e9sente une chaleur significative. Assurez-vous que le bo\u00eetier permet une convection passive si l'\u00e9tat \"Tout ON\" est possible.</li> <li>Optimisation Firmware: Impl\u00e9mentez un \"d\u00e9marrage progressif\" ou une activation s\u00e9quenc\u00e9e des relais pour \u00e9viter que les pics de courant (appel) ne saturent le rail d'alimentation simultan\u00e9ment.</li> </ol>"},{"location":"downloads/","title":"T\u00e9l\u00e9chargements (Downloads)","text":"<p>Acc\u00e9der aux ressources techniques pour imprimer les pi\u00e8ces m\u00e9caniques ou fabriquer la carte \u00e9lectronique.</p>"},{"location":"downloads/#schemas-electroniques","title":"Sch\u00e9mas \u00c9lectroniques","text":"<p>Le sch\u00e9ma complet de la carte SC940D au format PDF pour consultation et r\u00e9paration.</p> <ul> <li>[x] \ud83d\udcc2 Sch\u00e9ma SC940D (PDF) -&gt; T\u00e9l\u00e9charger</li> </ul>"},{"location":"downloads/#modelisation-3d","title":"Mod\u00e9lisation 3D","text":"<p>Fichier STEP de la carte compl\u00e8te pour l'int\u00e9gration m\u00e9canique.</p> <ul> <li>[x] \ud83d\udce6 Mod\u00e8le 3D SC940D (STEP) -&gt; T\u00e9l\u00e9charger</li> </ul>"},{"location":"downloads/#fabrication-gerbers","title":"Fabrication (Gerbers)","text":"<p>Dossier de fabrication complet (Gerber X2) pour la production du PCB.</p> <ul> <li>[x] \ud83c\udfed Fichiers de Fabrication SC940D (ZIP) -&gt; T\u00e9l\u00e9charger</li> </ul>"},{"location":"firmware/","title":"Documentation du Firmware","text":"<p>Le firmware de la carte SC940D est d\u00e9velopp\u00e9 en C pour le microcontr\u00f4leur Microchip PIC16F946.</p>"},{"location":"firmware/#environnement-de-developpement","title":"Environnement de D\u00e9veloppement","text":"<ul> <li>Compilateur: Hi-Tech C pour PIC10/12/16.</li> <li>IDE: MPLAB X (Fichier projet <code>essensys_ba.X</code>).</li> <li>MCU: PIC16F946.</li> <li>Horloge: Oscillateur High Speed (HS).</li> <li>Watchdog: D\u00e9sactiv\u00e9 au d\u00e9marrage (<code>WDTDIS</code>).</li> </ul>"},{"location":"firmware/#structure-du-projet","title":"Structure du Projet","text":"<p>Le code source se trouve dans <code>SC940D/Prog/code_ba (fichiers sources 1.7)/source/</code>.</p> Fichier Description <code>main.c</code> Point d'entr\u00e9e, initialisation et gestion EEPROM. <code>hard.c/h</code> Couche d'Abstraction Mat\u00e9rielle (HAL). D\u00e9finition des broches et I/O de bas niveau. <code>gestionentrees.c</code> Traitement des signaux d'entr\u00e9e et anti-rebond. <code>gestionsorties.c</code> Logique de commande des sorties (Relais). <code>variateur.c</code> Algorithmes de contr\u00f4le des gradateurs (\"Variateurs\"). <code>traitement.c</code> Logique applicative principale et machine \u00e0 \u00e9tats. <code>slavenode.c</code> Impl\u00e9mentation du protocole de communication (Bus I2C)."},{"location":"firmware/#cartographie-memoire-eeprom","title":"Cartographie M\u00e9moire (EEPROM)","text":"<p>L'EEPROM est utilis\u00e9e pour stocker la configuration persistante et l'\u00e9tat.</p> Adresse Description <code>0x000D</code> Version du Mapping EEPROM. <code>0x000E-0F</code> V\u00e9rification d'initialisation (<code>0xAA55</code>). <code>0x0010-11</code> \u00c9tat des Relais (LSB/MSB). <code>0x0012-29</code> Configuration Variateurs (Niveau actuel, Niveau sauvegard\u00e9, Mode). <code>0x002A-31</code> Temps d'action des Volets. <code>0x0032-42</code> Temps d'extinction des lampes."},{"location":"firmware/#fonctionnalites-cles","title":"Fonctionnalit\u00e9s Cl\u00e9s","text":"<ol> <li>Persistance d'\u00c9tat: Les \u00e9tats des relais et niveaux des variateurs sont sauvegard\u00e9s en EEPROM pour restaurer l'\u00e9tat apr\u00e8s une coupure de courant.</li> <li>Gestion des Entr\u00e9es: Traitement direct des entr\u00e9es num\u00e9riques avec anti-rebond.</li> <li>Contr\u00f4le de Charge:<ul> <li>Relais: Contr\u00f4le simple On/Off.</li> <li>Variateurs: Contr\u00f4le de phase ou PWM pour l'\u00e9clairage.</li> <li>Volets: Contr\u00f4le temporis\u00e9 pour l'ouverture/fermeture des stores.</li> </ul> </li> <li>Communication: Utilise un protocole \"N\u0153ud Esclave\" propri\u00e9taire, via I2C pour communiquer avec le contr\u00f4leur central (<code>SC944D</code>).</li> </ol>"},{"location":"firmware/#adressage-et-mapping-des-entrees-logique-vs-physique","title":"Adressage et Mapping des Entr\u00e9es (Logique vs Physique)","text":"<p>Le firmware utilise des tables de correspondance statiques (d\u00e9finies dans <code>gestionentrees.c</code>) pour associer les Entr\u00e9es Logiques (index utilis\u00e9 par le protocole) aux Broches Physiques du microcontr\u00f4leur (<code>ENTREE0</code> \u00e0 <code>ENTREE21</code>).</p> <p>\u26a0\ufe0f Attention : Vous ne pouvez pas utiliser n'importe quelle broche d'entr\u00e9e pour n'importe quelle fonction. L'assignation est fix\u00e9e par la configuration logicielle de la carte (d\u00e9finie \u00e0 la compilation par des <code>#define</code>).</p> <p>Voici les mappings extraits du code source :</p>"},{"location":"firmware/#configuration-type_chambres","title":"Configuration <code>TYPE_CHAMBRES</code>","text":"Type Logique Index Logique Mapped sur Physique Pin Physique (Est.) TOR 0 <code>ENTREE0</code> RB0 TOR 1 <code>ENTREE2</code> RF4 TOR 2 <code>ENTREE3</code> RF3 TOR 3 <code>ENTREE9</code> RG2 TOR 4 <code>ENTREE10</code> RG1 TOR 5 <code>ENTREE14</code> RD4 TOR 6 <code>ENTREE18</code> RC0 Variateur 0 <code>ENTREE1</code> RF5 Variateur 1 <code>ENTREE8</code> RG3 Variateur 2 <code>ENTREE13</code> RD5 Variateur 3 <code>ENTREE17</code> RD0 Volet 0 <code>ENTREE4</code> RF1 Volet ... ... ... <p>(Note : Les correspondances Pin/Port exactes d\u00e9pendent de <code>hard.h</code>)</p> <p>Ce m\u00e9canisme confirme que m\u00eame si les entr\u00e9es <code>IN0</code> \u00e0 <code>IN12</code> sont physiquement pr\u00e9sentes sur le connecteur, elles ne seront \"vues\" par le firmware que si elles sont d\u00e9clar\u00e9es dans ces tables de mapping.</p>"},{"location":"firmware/#analyse-de-la-communication-maitre-esclave","title":"Analyse de la Communication Ma\u00eetre-Esclave","text":"<p>La carte SC940D agit comme un module d'Entr\u00e9e/Sortie esclave g\u00e9n\u00e9rique, pilot\u00e9 par un concentrateur ma\u00eetre (ex: 944D).</p>"},{"location":"firmware/#protocole","title":"Protocole","text":"<ul> <li>Couche Physique: I2C (bas\u00e9 sur le nommage <code>slavenode.c</code> et l'usage de <code>SSPBUF</code>).</li> <li>M\u00e9canisme:<ol> <li>Interruption: <code>SSP_Handler</code> re\u00e7oit les octets bruts dans <code>RXBuffer</code>.</li> <li>Validation: Un Checksum est calcul\u00e9 (<code>us_CalculerCRCSurTrame</code>). Si valide, les donn\u00e9es sont copi\u00e9es dans <code>CmdBuf</code>.</li> <li>Ex\u00e9cution: La boucle principale appelle <code>vd_Traitement_I2C</code> qui traite <code>CmdBuf</code>.</li> </ol> </li> </ul>"},{"location":"firmware/#diagramme-de-flux-logique-firmware","title":"Diagramme de Flux (Logique Firmware)","text":"<pre><code>graph TD\n    subgraph Interrupt[Interruption - ISR]\n        ISR(SSP_Handler) --&gt; Recv[R\u00e9ception Octet]\n        Recv --&gt; Buffer{\"Buffer Plein ?\"}\n        Buffer -- Non --&gt; Store[Stockage RXBuffer]\n        Buffer -- Oui --&gt; Checksum[V\u00e9rif. Checksum]\n        Checksum -- Valide --&gt; Copy[Copie vers CmdBuf]\n        Checksum -- Invalide --&gt; Error[Flag Erreur]\n    end\n\n    subgraph MainLoop[Boucle Principale]\n        Start((D\u00e9part)) --&gt; Init[Initialisation]\n        Init --&gt; Loop{\"While(1)\"}\n        Loop --&gt; Task1[vd_Traitement_I2C]\n        Task1 --&gt; CmdCheck{\"CmdBuf[0] != 0?\"}\n\n        CmdCheck -- Oui --&gt; Switch[Switch Commande]\n        Switch --&gt; C1[C_FORCAGE_SORTIES]\n        Switch --&gt; C2[C_CONF_SORTIES]\n        Switch --&gt; C3[C_TPS_EXTINCTION]\n\n        C1 --&gt; Action1[M\u00e0J Relais/Variateurs]\n        C2 --&gt; Action2[M\u00e0J Config &amp; EEPROM]\n        C3 --&gt; Action3[M\u00e0J Timers &amp; EEPROM]\n\n        Action1 --&gt; Reset[\"CmdBuf[0] = 0\"]\n        Action2 --&gt; Reset\n        Action3 --&gt; Reset\n\n        Reset --&gt; Loop\n        CmdCheck -- Non --&gt; Loop\n    end</code></pre>"},{"location":"firmware/#commandes-du-protocole","title":"Commandes du Protocole","text":"ID Commande Nom Description <code>0x01</code> <code>C_FORCAGE_SORTIES</code> Force l'\u00e9tat des relais, variateurs ou volets. <code>0x02</code> <code>C_CONF_SORTIES</code> Configure le mode variateur (On/Off ou Gradation). <code>0x03</code> <code>C_TPS_EXTINCTION</code> D\u00e9finit le temps d'extinction auto pour les lampes. <code>0x04</code> <code>C_TPS_ACTION</code> D\u00e9finit le temps de mouvement pour les volets. <code>0x05</code> <code>C_ACTIONS</code> D\u00e9clenche des actions globales (ex: Sauvegarde \u00c9tat)."},{"location":"hardware/","title":"Conception Mat\u00e9rielle (Hardware Design)","text":"<p>La conception mat\u00e9rielle se trouve dans le r\u00e9pertoire <code>SC940D</code>.</p>"},{"location":"hardware/#schemas-electroniques","title":"Sch\u00e9mas \u00c9lectroniques","text":"<p>Le projet comprend plusieurs feuilles de sch\u00e9ma : - SC940D_Coeur.SchDoc: C\u0153ur logique (MCU). - SC940D_Borniers.SchDoc: Connecteurs. - SC940D_ETOR1.SchDoc, SC940D_ETOR2.SchDoc: Configurations des Entr\u00e9es/Sorties. - SC940D_STORRB.SchDoc, SC940D_STORRM.SchDoc: Composants de stockage/m\u00e9moire (Relais Bistables/Monostables). - SC940D_Variateurs.SchDoc: Contr\u00f4le des variateurs.</p>"},{"location":"hardware/#routage-pcb","title":"Routage PCB","text":"<p>Le routage du circuit imprim\u00e9 est d\u00e9fini dans <code>SI940D.PcbDoc</code>.</p>"},{"location":"hardware/#documentation-pdf","title":"Documentation PDF","text":"<ul> <li>Sch\u00e9ma PDF (SC942-0B)</li> <li>Plans d'Assemblage (SC942-0B)</li> <li>Datasheet Contr\u00f4leur (41250f)</li> </ul>"},{"location":"hardware/#fabrication","title":"Fabrication","text":"<p>Les fichiers de fabrication se trouvent dans <code>SC940D/Gerbers</code> et <code>SC940D/Assembly</code>.</p>"}]}